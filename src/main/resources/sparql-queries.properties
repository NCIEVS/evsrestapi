
prefix.common=PREFIX owl:<http://www.w3.org/2002/07/owl#> \
PREFIX rdf:<http://www.w3.org/1999/02/22-rdf-syntax-ns#> \
PREFIX rdfs:<http://www.w3.org/2000/01/rdf-schema#> \
PREFIX xsd:<http://www.w3.org/2001/XMLSchema#> \
PREFIX dc:<http://purl.org/dc/elements/1.1/> \
PREFIX oboInOwl:<http://www.geneontology.org/formats/oboInOwl#> \
PREFIX xml:<http://www.w3.org/2001/XMLSchema#>

prefix.graph=PREFIX :<#{source}#> \
PREFIX base:<#{source}>

prefix.chebi=PREFIX :<http://purl.obolibrary.org/obo/chebi.owl#> \
PREFIX base:<http://purl.obolibrary.org/obo/chebi.owl#> \
PREFIX chebi:<http://purl.obolibrary.org/obo/chebi/> \
PREFIX CHEBI:<http://purl.obolibrary.org/obo/chebi/> \
PREFIX obo:<http://purl.obolibrary.org/obo>

prefix.hgnc=PREFIX :<http://ncicb.nci.nih.gov/genenames.org/HGNC.owl#> \
PREFIX HGNC:<http://ncicb.nci.nih.gov/genenames.org/HGNC.owl#>

prefix.go=PREFIX obo1:<http://purl.obolibrary.org/obo> \
PREFIX GO:<http://purl.obolibrary.org/obo/go.owl>

all.graph.names=select distinct ?graphName where { graph ?graphName {?s ?p ?o} }

all.graphs.and.versions=select distinct ?source ?graphName ?version ?date \
{ GRAPH ?graphName \
  { \
    { \
      ?source a owl:Ontology . \
      ?source owl:versionInfo ?version \
      OPTIONAL { ?source (dc:date|oboInOwl:date) ?date } \
    } \
    UNION \
    { \
      ?source a owl:Ontology . \
      ?source owl:versionIRI ?version . \
      OPTIONAL { ?source (dc:date|oboInOwl:date) ?date } \
      FILTER NOT EXISTS { ?source owl:versionInfo ?versionInfo } \
    } \
  } \
}

axiom.qualifier=SELECT DISTINCT ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { ?x a owl:Axiom . \
    ?x #{propertyCode} ?propertyValue \
  } \
} \
ORDER BY ?propertyValue

properties=SELECT ?property ?propertyCode ?propertyLabel ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { \
    ?x #{codeCode} "#{conceptCode}" . \
    ?x ?property ?propertyValue . \
    ?property a owl:AnnotationProperty . \
    OPTIONAL { ?property #{preferredNameCode} ?propertyLabel } . \
    OPTIONAL { ?property #{codeCode} ?propertyCode } . \
    FILTER NOT EXISTS { ?property rdfs:range xml:anyURI } \
  } \
}

properties.metadata=SELECT ?property ?propertyCode  ?propertyLabel ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { \
    <#{about}> ?property ?propertyValue . \
    OPTIONAL { ?property #{preferredNameCode} ?propertyLabel } . \
    OPTIONAL { ?property #{codeCode} ?propertyCode } . \
    FILTER NOT EXISTS { ?property rdfs:range xml:anyURI } \
  } \
}

properties.batch=SELECT ?conceptCode ?property ?propertyCode ?propertyLabel ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { \
    ?x a owl:Class . \
    ?x #{codeCode} ?conceptCode . \
    FILTER (?conceptCode IN (#{inClause})) . \
    ?x ?property ?propertyValue . \
    ?property a owl:AnnotationProperty . \
    OPTIONAL { ?property #{preferredNameCode} ?propertyLabel } . \
    OPTIONAL { ?property #{codeCode} ?propertyCode } . \
    FILTER NOT EXISTS { ?property rdfs:range xml:anyURI } \
  } \
} \
ORDER BY ?conceptCode ?propertyCode


concept.label=SELECT distinct ?concept ?conceptLabel \
{ GRAPH <#{namedGraph}> \
  { \
    ?concept #{codeCode} "#{conceptCode}" . \
    OPTIONAL { ?concept #{preferredNameCode} ?conceptLabel } \
  } \
}

axiom=SELECT ?axiom ?axiomProperty  ?axiomValue \
{ GRAPH <#{namedGraph}> \
  { \
    ?axiom a owl:Axiom . \
    ?axiom owl:annotatedSource #{refCode} . \
    ?axiom ?axiomProperty ?axiomValue \
  } \
} \
ORDER BY ?axiom

axioms.batch=SELECT ?conceptCode ?axiom ?axiomProperty ?axiomValue \
{ GRAPH <#{namedGraph}> \
  { \
    ?x a owl:Class . \
    ?x #{codeCode} ?conceptCode . \
    FILTER (?conceptCode IN (#{inClause})) . \
    ?axiom a owl:Axiom . \
    ?axiom owl:annotatedSource ?x . \
    ?axiom ?axiomProperty ?axiomValue \
  } \
} \
ORDER BY ?axiom

children=SELECT ?child ?childLabel ?childCode \
{ GRAPH <#{namedGraph}> \
  { \
    { \
      { \
        ?x_parent a owl:Class . \
        ?x_parent #{codeCode} "#{conceptCode}" . \
        ?child rdfs:subClassOf ?x_parent . \
        ?child a owl:Class . \
        OPTIONAL { ?child #{preferredNameCode} ?childLabel } . \
        OPTIONAL { ?child #{codeCode} ?childCode } \
      } \
      FILTER (?x_parent != ?child) \
    } \
    UNION \
    { \
      { \
        ?x_parent a owl:Class . \
        ?x_parent #{codeCode} "#{conceptCode}" . \
        ?x_equiv_concept owl:intersectionOf ?y . \
        ?y rdf:rest*/rdf:first ?x_parent . \
        ?child owl:equivalentClass ?x_equiv_concept . \
        ?child a owl:Class . \
        OPTIONAL { ?child #{preferredNameCode} ?childLabel } . \
        OPTIONAL { ?child #{codeCode} ?childCode } \
      } \
      FILTER (?x_parent != ?child) \
    } \
  } \
} \
ORDER by ?childLabel

parents=SELECT ?parent ?parentLabel ?parentCode \
{ GRAPH <#{namedGraph}> \
  { \
    { \
      { \
        ?x_child a owl:Class . \
        ?x_child #{codeCode} "#{conceptCode}" . \
        ?x_child rdfs:subClassOf ?parent . \
        ?parent a owl:Class . \
        OPTIONAL { ?parent #{preferredNameCode} ?parentLabel } . \
        OPTIONAL { ?parent #{codeCode} ?parentCode } \
      } \
      FILTER (?x_child != ?parent) \
    } \
    UNION \
    { \
      { \
        ?x_child a owl:Class . \
        ?x_child #{codeCode} "#{conceptCode}" . \
        ?x_equiv_concept owl:intersectionOf ?y2 . \
        ?y2 rdf:rest*/rdf:first ?parent . \
        ?x_child owl:equivalentClass ?x_equiv_concept . \
        ?parent a owl:Class . \
        OPTIONAL { ?parent #{preferredNameCode} ?parentLabel } . \
        OPTIONAL { ?parent #{codeCode} ?parentCode } \
      } \
      FILTER (?x_child != ?parent) \
    } \
  } \
} \
ORDER by ?parentLabel

subset=SELECT ?concept ?conceptLabel ?conceptCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?concept a owl:Class . \
    ?concept #{preferredNameCode} ?conceptLabel . \
    ?concept #{codeCode} ?conceptCode . \
    ?y a owl:AnnotationProperty . \
    ?concept ?y ?z . \
    ?z #{codeCode} "#{conceptCode}" . \
    ?y rdfs:label "Concept_In_Subset" . \
  } \
}

#         OPTIONAL { ?relationship #{codeCode} ?relationshipCode . \
associations=SELECT ?relationship ?relationshipLabel ?relatedConcept ?relatedConceptCode ?relatedConceptLabel \
{ GRAPH <#{namedGraph}> \
  { \
    ?x a owl:Class . \
    ?x #{codeCode} "#{conceptCode}" . \
    ?relationship a owl:AnnotationProperty . \
    ?x ?relationship ?relatedConcept . \
    ?relatedConcept a owl:Class . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
    ?relationship rdfs:range ?y_range \
  }\
  FILTER (str(?y_range)=\"http://www.w3.org/2001/XMLSchema#anyURI\") \
} \
ORDER BY ?relationship ?relatedConceptLabel

#        ?relationship #{codeCode} ?relationshipCode . \
associations.batch=SELECT ?conceptCode ?relationship ?relationshipLabel ?relatedConcept ?relatedConceptCode ?relatedConceptLabel \
{ GRAPH <#{namedGraph}> \
  { \
    ?x a owl:Class . \
    ?x #{codeCode} ?conceptCode . \
    FILTER (?conceptCode IN (#{inClause})) . \
    ?relationship a owl:AnnotationProperty . \
    ?x ?relationship ?relatedConcept . \
    ?relatedConcept a owl:Class . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
    ?relationship rdfs:range ?y_range \
  } \
  FILTER (str(?y_range)="http://www.w3.org/2001/XMLSchema#anyURI") \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

#        ?relationship #{codeCode} ?relationshipCode . \
inverse.associations=SELECT ?relationship ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?z a owl:Class . \
    ?z #{codeCode} "#{conceptCode}" . \
    ?relatedConcept a owl:Class . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
    ?relationship a owl:AnnotationProperty . \
    ?relatedConcept ?relationship ?z . \
    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
    ?relationship rdfs:range ?y_range \
  } \
  FILTER (str(?y_range)=\"http://www.w3.org/2001/XMLSchema#anyURI\") \
} \
ORDER BY ?relationship ?relatedConceptLabel

#         ?relationship #{codeCode} ?relationshipCode . \
inverse.associations.batch=SELECT ?conceptCode ?relationship ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?z a owl:Class . \
    ?z #{codeCode} ?conceptCode . \
    FILTER (?conceptCode IN (#{inClause})) . \
    ?relatedConcept a owl:Class . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
    ?relationship a owl:AnnotationProperty . \
    ?relatedConcept ?relationship ?z . \
    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
    ?relationship rdfs:range ?y_range \
  } \
  FILTER (str(?y_range)="http://www.w3.org/2001/XMLSchema#anyURI") \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

inverse.roles=SELECT distinct ?relationship ?relationshipCode ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Class . \
      ?z5 owl:intersectionOf ?z6 . \
      ?z6 rdf:rest*/rdf:first ?z7 . \
      ?z7 a owl:Restriction . \
      ?z7 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z7 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:unionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Class . \
      ?z5 owl:intersectionOf ?z6 . \
      ?z6 rdf:rest*/rdf:first ?z7 . \
      ?z7 a owl:Restriction . \
      ?z7 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z7 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:unionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:unionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
   UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:unionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Restriction . \
      ?z1 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z1 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} "#{conceptCode}" . \
      } \
    } \
}  \
ORDER BY ?relationship ?relatedConceptLabel

inverse.roles.chebi=SELECT distinct ?relationship ?relationshipCode ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?relatedConcept a owl:Class . \
    OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    ?relatedConcept rdfs:subClassOf ?z1 . \
    ?z1 a owl:Restriction . \
    ?z1 owl:onProperty ?relationship . \
    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
    OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
    ?z1 owl:someValuesFrom ?y . \
    ?y a owl:Class . \
    ?y #{codeCode} "#{conceptCode}" . \
  } \
}  \
ORDER BY ?relationship ?relatedConceptLabel

inverse.roles.batch=SELECT distinct ?conceptCode ?relationship ?relationshipCode ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { \
    { \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Class . \
      ?z5 owl:intersectionOf ?z6 . \
      ?z6 rdf:rest*/rdf:first ?z7 . \
      ?z7 a owl:Restriction . \
      ?z7 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z7 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:unionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Class . \
      ?z5 owl:intersectionOf ?z6 . \
      ?z6 rdf:rest*/rdf:first ?z7 . \
      ?z7 a owl:Restriction . \
      ?z7 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z7 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:unionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:unionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:unionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
    UNION \
    { ?relatedConcept #{codeCode} ?relatedConceptCode . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept rdfs:subClassOf ?z1 . \
      ?z1 a owl:Restriction . \
      ?z1 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z1 owl:someValuesFrom ?y . \
      ?y a owl:Class . \
      ?y #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
    } \
  } \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

inverse.roles.batch.chebi=SELECT distinct ?conceptCode ?relationship ?relationshipCode ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { ?relatedConcept #{codeCode} ?relatedConceptCode . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    ?relatedConcept rdfs:subClassOf ?z1 . \
    ?z1 a owl:Restriction . \
    ?z1 owl:onProperty ?relationship . \
    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
    OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
    ?z1 owl:someValuesFrom ?y . \
    ?y a owl:Class . \
    ?y #{codeCode} ?conceptCode . \
    FILTER (?conceptCode IN (#{inClause})) . \
  } \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

roles=SELECT distinct ?relationship ?relationshipCode ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode  \
{ GRAPH <#{namedGraph}> \
  { \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Class . \
      ?z5 owl:intersectionOf ?z6 . \
      ?z6 rdf:rest*/rdf:first ?z7 . \
      ?z7 a owl:Restriction . \
      ?z7 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode }. \
      ?z7 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL {  ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:unionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Class . \
      ?z5 owl:intersectionOf ?z6 . \
      ?z6 rdf:rest*/rdf:first ?z7 . \
      ?z7 a owl:Restriction . \
      ?z7 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z7 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:unionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:unionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:unionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} "#{conceptCode}" . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Restriction . \
      ?z1 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z1 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
  } \
} \
ORDER BY ?relationship ?relatedConceptLabel

roles.chebi=SELECT distinct ?relationship ?relationshipCode ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode  \
{ GRAPH <#{namedGraph}> \
  { ?x #{codeCode} "#{conceptCode}" . \
    ?x rdfs:subClassOf ?z1 . \
    ?z1 a owl:Restriction . \
    ?z1 owl:onProperty ?relationship . \
    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
    OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
    ?z1 owl:someValuesFrom ?relatedConcept . \
    ?relatedConcept a owl:Class . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    ?relatedConcept #{codeCode} ?relatedConceptCode . \
  } \
} \
ORDER BY ?relationship ?relatedConceptLabel

roles.batch=SELECT distinct ?conceptCode ?relationship ?relationshipCode ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Class . \
      ?z5 owl:intersectionOf ?z6 . \
      ?z6 rdf:rest*/rdf:first ?z7 . \
      ?z7 a owl:Restriction . \
      ?z7 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z7 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:unionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Class . \
      ?z5 owl:intersectionOf ?z6 . \
      ?z6 rdf:rest*/rdf:first ?z7 . \
      ?z7 a owl:Restriction . \
      ?z7 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z7 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:unionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode }. \
      ?z5 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x owl:equivalentClass ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:intersectionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode  . \
      ?z3 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:unionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Class . \
      ?z3 owl:intersectionOf ?z4 . \
      ?z4 rdf:rest*/rdf:first ?z5 . \
      ?z5 a owl:Restriction . \
      ?z5 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z5 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Class . \
      ?z1 owl:unionOf ?z2 . \
      ?z2 rdf:rest*/rdf:first ?z3 . \
      ?z3 a owl:Restriction . \
      ?z3 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z3 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
    UNION \
    { ?x #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?x rdfs:subClassOf ?z1 . \
      ?z1 a owl:Restriction . \
      ?z1 owl:onProperty ?relationship . \
      OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
      OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
      ?z1 owl:someValuesFrom ?relatedConcept . \
      ?relatedConcept a owl:Class . \
      OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
      ?relatedConcept #{codeCode} ?relatedConceptCode . \
    } \
  } \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

roles.batch.chebi=SELECT distinct ?conceptCode ?relationship ?relationshipCode ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { ?x #{codeCode} ?conceptCode . \
    FILTER (?conceptCode IN (#{inClause})) . \
    ?x rdfs:subClassOf ?z1 . \
    ?z1 a owl:Restriction . \
    ?z1 owl:onProperty ?relationship . \
    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
    OPTIONAL { ?relationship #{codeCode} ?relationshipCode } . \
    ?z1 owl:someValuesFrom ?relatedConcept . \
    ?relatedConcept a owl:Class . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    ?relatedConcept #{codeCode} ?relatedConceptCode . \
  } \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

# relationship label is bound to "disjointWith"
disjoint.with=SELECT ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?x a owl:Class . \
    ?x #{codeCode} "#{conceptCode}" . \
    ?x owl:disjointWith ?relatedConcept . \
    OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } \
  } \
}

# relationship label is bound to "disjointWith"
disjoint.with.batch=SELECT ?conceptCode ?relatedConcept ?relatedConceptCode ?relatedConceptLabel \
{ GRAPH <#{namedGraph}> \
  { \
    ?x a owl:Class . \
    ?x #{codeCode} ?conceptCode . \
    FILTER (?conceptCode IN (#{inClause})) . \
    ?x owl:disjointWith ?relatedConcept . \
    OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } \
  } \
} \
ORDER BY ?conceptCode

# (1) owl:Class|rdfs:subClassOf|owl:Class
# (2) owl:Class|owl:equivalentClass|owl:Class|owl:intersectionOf|owl:Class
# (3) owl:Class|rdfs:subClassOf|owl:Class|owl:intersectionOf|owl:Class
hierarchy=SELECT ?parent ?parentCode ?parentLabel ?child ?childCode ?childLabel \
{ GRAPH <#{namedGraph}> \
  { \
    { \
      { \
        ?child a owl:Class . \
        OPTIONAL { ?child #{preferredNameCode} ?childLabel } . \
        OPTIONAL { ?child #{codeCode} ?childCode } . \
        ?child rdfs:subClassOf ?parent . \
        ?parent a owl:Class . \
        OPTIONAL { ?parent #{preferredNameCode} ?parentLabel } . \
        OPTIONAL { ?parent #{codeCode} ?parentCode } \
      } \
    } \
    UNION \
    { \
      { \
        ?child a owl:Class . \
        OPTIONAL {  ?child #{preferredNameCode} ?childLabel } . \
        OPTIONAL { ?child #{codeCode} ?childCode } . \
        ?child owl:equivalentClass ?y . \
        ?y a owl:Class . \
        ?y owl:intersectionOf ?y2 . \
        ?y2 rdf:rest*/rdf:first ?parent . \
        ?parent a owl:Class . \
        OPTIONAL { ?parent #{preferredNameCode} ?parentLabel } . \
        OPTIONAL { ?parent #{codeCode} ?parentCode } \
      } \
    } \
    UNION \
    { \
      { \
        ?child a owl:Class . \
        OPTIONAL { ?child #{preferredNameCode} ?childLabel } . \
        OPTIONAL { ?child #{codeCode} ?childCode } . \
        ?child rdfs:subClassOf ?y . \
        ?y a owl:Class . \
        ?y owl:intersectionOf ?y2 . \
        ?y2 rdf:rest*/rdf:first ?parent . \
        ?parent a owl:Class . \
        OPTIONAL { ?parent #{preferredNameCode} ?parentLabel } . \
        OPTIONAL { ?parent #{codeCode} ?parentCode } \
      } \
    } \
  } \
}

# Get all properties with literal values not URI values
all.properties=SELECT ?property ?propertyCode \
{ GRAPH <#{namedGraph}> \
  { ?property a owl:AnnotationProperty . \
    OPTIONAL { ?property #{codeCode} ?propertyCode } . \
    FILTER NOT EXISTS { ?property rdfs:range xml:anyURI } \
  } \
}


# distinct property values (String properytCode, String namedGraph)
# for all concepts, regardless of status
distinct.property.values=SELECT DISTINCT ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { \
    ?x a owl:Class . \
    ?x #{propertyCode} ?propertyValue \
  } \
}

all.qualifiers=SELECT DISTINCT ?property ?propertyCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?x owl:annotatedProperty ?y . \
    ?y a owl:AnnotationProperty . \
    ?property a owl:AnnotationProperty . \
    ?x ?property ?z . \
    OPTIONAL { ?property #{codeCode} ?propertyCode } \
  } \
} \
ORDER BY ?propertyCode

all.properties.never.used=SELECT DISTINCT ?property ?propertyCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?property a owl:AnnotationProperty . \
    ?property #{codeCode} ?propertyCode . \
    FILTER NOT EXISTS { ?x ?property ?z } \
  } \
} \
ORDER BY ?propertyCode

# Annotation properties with URI range (to differentiate from properties)
all.associations=SELECT ?property ?propertyCode  \
{ GRAPH <#{namedGraph}> \
  { ?property a owl:AnnotationProperty . \
    ?property #{codeCode} ?propertyCode . \
    ?property rdfs:range xml:anyURI  \
  } \
}

all.roles=SELECT ?property ?propertyCode  \
{ GRAPH <#{namedGraph}> \
  { ?property a owl:ObjectProperty . \
    ?property #{codeCode} ?propertyCode . \
  } \
}

# find all property values used for the specified axiom qualifier
# except those values used on retired concepts
axiom.qualifier.values=SELECT DISTINCT ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { \
    ?x a owl:Axiom . \
    ?y a owl:Class . \
    ?x owl:annotatedSource ?y . \
    ?x #{propertyCode} ?propertyValue . \
    FILTER NOT EXISTS { ?y #{conceptStatusCode} "#{retiredStatusValue}" } \
  } \
} \
ORDER BY ?propertyValue

all.concepts.with.code=SELECT ?concept ?conceptCode ?conceptLabel \
{ GRAPH <#{namedGraph}> \
    { \
        ?concept a owl:Class . \
        ?concept #{codeCode} ?conceptCode . \
        OPTIONAL { ?concept #{preferredNameCode} ?conceptLabel } . \
    } \
} \
ORDER BY ?conceptCode 

all.concepts.without.code=SELECT ?concept ?conceptLabel \
{ GRAPH <#{namedGraph}> \
    { \
        ?concept a owl:Class . \
        OPTIONAL { ?concept #{preferredNameCode} ?conceptLabel } . \
        FILTER NOT EXISTS { ?concept #{codeCode} ?x } \
    } \
} \
ORDER BY ?conceptCode 

association.entries=SELECT ?concept ?conceptCode ?conceptLabel ?relatedConcept ?relatedConceptCode ?relatedConceptLabel \
{ GRAPH <#{namedGraph}> \
  { \
    ?concept a owl:Class . \
    OPTIONAL { ?concept #{codeCode} ?conceptCode } . \
    OPTIONAL { ?concept #{preferredNameCode} ?conceptLabel } . \
    ?y a owl:AnnotationProperty . \
    ?concept ?y ?relatedConcept . \
    ?relatedConcept a owl:Class . \
    OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
    OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
    ?y #{codeCode} "#{conceptCode}" . \
    ?y rdfs:range ?y_range \
  } \
  FILTER (str(?y_range)=\"http://www.w3.org/2001/XMLSchema#anyURI\") \
}
