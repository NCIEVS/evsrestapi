
prefix.common=PREFIX owl:<http://www.w3.org/2002/07/owl#> \
PREFIX rdf:<http://www.w3.org/1999/02/22-rdf-syntax-ns#> \
PREFIX rdfs:<http://www.w3.org/2000/01/rdf-schema#> \
PREFIX xsd:<http://www.w3.org/2001/XMLSchema#> \
PREFIX dc:<http://purl.org/dc/elements/1.1/> \
PREFIX oboInOwl:<http://www.geneontology.org/formats/oboInOwl#> \
PREFIX xml:<http://www.w3.org/2001/XMLSchema#>

prefix.graph=PREFIX :<#{source}#> \
PREFIX base:<#{source}>

prefix.chebi=PREFIX :<http://purl.obolibrary.org/obo/chebi.owl#> \
PREFIX base:<http://purl.obolibrary.org/obo/chebi.owl#> \
PREFIX chebi:<http://purl.obolibrary.org/obo/chebi/> \
PREFIX CHEBI:<http://purl.obolibrary.org/obo/chebi/> \
PREFIX obo:<http://purl.obolibrary.org/obo>

prefix.hgnc=PREFIX :<http://ncicb.nci.nih.gov/genenames.org/HGNC.owl#> \
PREFIX HGNC:<http://ncicb.nci.nih.gov/genenames.org/HGNC.owl#>

prefix.go=PREFIX obo1:<http://purl.obolibrary.org/obo> \
PREFIX GO:<http://purl.obolibrary.org/obo/go.owl>


# constructAllGraphNamesQuery()
all.graph.names=select distinct ?graphName where { graph ?graphName {?s ?p ?o} }

# constructAllGraphsAndVersionsQuery
all.graphs.and.versions=select distinct ?source ?graphName ?version ?date where { \
  graph ?graphName { \
    { \
      ?source a owl:Ontology . \
      ?source owl:versionInfo ?version \
      OPTIONAL { ?source (dc:date|oboInOwl:date) ?date } \
    } \
    UNION \
    { \
      ?source a owl:Ontology . \
      ?source owl:versionIRI ?version . \
      OPTIONAL { ?source (dc:date|oboInOwl:date) ?date } \
      FILTER NOT EXISTS { ?source owl:versionInfo ?versionInfo } \
    } \
  } \
}

# constructAxiomQualifierQuery(String propertyCode, String namedGraph)
axiom.qualifier=SELECT DISTINCT ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { ?axiom a owl:Axiom . \
    ?axiom #{propertyCode} ?propertyValue \
  } \
} \
ORDER BY ?propertyValue

# constructPropertyQuery(String conceptCode, String namedGraph)
property=SELECT ?property ?propertyCode ?propertyLabel ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { ?concept a owl:Class . \
    ?concept #{codeCode} "#{conceptCode}" . \
    ?concept ?property ?propertyValue . \
    ?property a owl:AnnotationProperty . \
    OPTIONAL { ?property #{preferredNameCode} ?propertyLabel } . \
    OPTIONAL { ?property #{codeCode} ?propertyCode } . \
    FILTER NOT EXISTS { ?property rdfs:range xml:anyURI } \
  } \
}

# constructPropertyNoRestrictionsQuery(String conceptCode, String namedGraph)
property.no.restrictions=SELECT ?property ?propertyCode  ?propertyLabel ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { ?concept #{codeCode} "#{conceptCode}" . \
    ?concept ?property ?propertyValue . \
    OPTIONAL { ?property #{preferredNameCode} ?propertyLabel } . \
    OPTIONAL { ?property #{codeCode} ?propertyCode } . \
    FILTER NOT EXISTS { ?property rdfs:range xml:anyURI } \
  } \
}

properties.batch=SELECT ?conceptCode ?property ?propertyCode ?propertyLabel ?propertyValue \
{ GRAPH <#{namedGraph}> { \
        ?concept a owl:Class . \
        ?concept #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
        ?concept ?property ?propertyValue . \
        ?property a owl:AnnotationProperty . \
        OPTIONAL { ?property #{preferredNameCode} ?propertyLabel } . \
        OPTIONAL { ?property #{codeCode} ?propertyCode } . \
        FILTER NOT EXISTS { ?property rdfs:range xml:anyURI } \
    } \
} \
ORDER BY ?conceptCode ?propertyCode


# constructConceptLabelQuery(String conceptCode, String namedGraph)
concept.label=SELECT distinct ?concept ?conceptLabel \
{ GRAPH <#{namedGraph}> \
  { \
    ?concept #{codeCode} "#{conceptCode}" . \
    OPTIONAL { ?concept #{preferredNameCode ?conceptLabel } \
  } \
}

# constructAxiomQuery(String conceptCode, String namedGraph)
axiom=SELECT ?axiom ?axiomProperty  ?axiomValue \
{ GRAPH <#{namedGraph}> \
    { \
      ?axiom a owl:Axiom . \
      ?axiom owl:annotatedSource #{refCode} . \
      ?axiom ?axiomProperty ?axiomValue \
    } \
} \
ORDER BY ?axiom

axioms.batch=SELECT ?conceptCode ?axiom ?axiomProperty ?axiomValue \
{ GRAPH <#{namedGraph}> { \
      ?concept a owl:Class . \
      ?concept #{codeCode} ?conceptCode . \
      FILTER (?conceptCode IN (#{inClause})) . \
      ?axiom a owl:Axiom . \
      ?axiom owl:annotatedSource ?concept . \
      ?axiom ?axiomProperty ?axiomValue \
    } \
} \
ORDER BY ?axiom

children=SELECT ?child ?childLabel ?childCode \
{ GRAPH <#{namedGraph}> \
        { \
          { \
            { \
              ?parent a owl:Class . \
              ?parent #{codeCode} "#{conceptCode}" . \
              ?child rdfs:subClassOf ?parent . \
              ?child a owl:Class . \
              ?child #{preferredNameCode} ?childLabel . \
              ?child #{codeCode} ?childCode \
            } \
            FILTER (?parent != ?child) \
          } \
          UNION \
          { \
            { \
              ?parent a owl:Class . \
              ?parent #{codeCode} "#{conceptCode}" . \
              ?equiv_concept owl:intersectionOf ?list . \
              ?list rdf:rest*/rdf:first ?parent . \
              ?child owl:equivalentClass ?equiv_concept . \
              ?child a owl:Class . \
              ?child #{preferredNameCode} ?childLabel . \
              ?child #{codeCode} ?childCode \
            } \
            FILTER (?parent != ?child) \
          } \
        } \
} \
ORDER by ?childLabel

children.batch=SELECT ?conceptCode ?child ?childLabel ?childCode \
{ GRAPH <#{namedGraph}> \
{ \
    { \
        { \
            ?parent a owl:Class . \
            ?parent #{codeCode} ?conceptCode  . \
            FILTER (?conceptCode IN (#{inClause})) . \
            ?child rdfs:subClassOf ?parent . \
            ?child a owl:Class . \
            ?child #{preferredNameCode} ?childLabel . \
            ?child #{codeCode} ?childCode \
        } \
        FILTER (?parent != ?child) \
    } \
    UNION \
    { \
        { \
            ?parent a owl:Class . \
            ?parent #{codeCode} ?conceptCode . \
            FILTER (?conceptCode IN (#{inClause})) . \
            ?equiv_concept owl:intersectionOf ?list . \
            ?list rdf:rest*/rdf:first ?parent . \
            ?child owl:equivalentClass ?equiv_concept . \
            ?child a owl:Class . \
            ?child #{preferredNameCode} ?childLabel . \
            ?child #{codeCode} ?childCode \
        } \
        FILTER (?parent != ?child) \
    } \
} \
} \
ORDER by ?conceptCode ?childLabel

# constructSuperconceptQuery(String conceptCode, String namedGraph)
parents=SELECT ?parent ?parentLabel ?parentCode \
{ GRAPH <#{namedGraph}> \
        { \
          { \
            { \
              ?child a owl:Class . \
              ?child #{codeCode} "#{conceptCode}" . \
              ?child rdfs:subClassOf ?parent . \
              ?parent a owl:Class . \
              ?parent #{preferredNameCode} ?parentLabel . \
              ?parent #{codeCode} ?parentCode \
            } \
            FILTER (?child != ?parent) \
          } \
          UNION \
          { \
            { \
              ?child a owl:Class . \
              ?child #{codeCode} "#{conceptCode}" . \
              ?equiv_concept owl:intersectionOf ?list . \
              ?list rdf:rest*/rdf:first ?parent . \
              ?child owl:equivalentClass ?equiv_concept . \
              ?parent a owl:Class . \
              ?parent #{preferredNameCode} ?parentLabel . \
              ?parent #{codeCode} ?parentCode \
            } \
            FILTER (?child != ?parent) \
          } \
        } \
} \
ORDER by ?parentLabel

parents.batch=SELECT ?conceptCode ?parent ?parentLabel ?parentCode \
{ GRAPH <#{namedGraph}> \
        { \
          { \
            { \
              ?child a owl:Class . \
              ?child #{codeCode} ?conceptCode . \
              FILTER (?conceptCode IN (#{inClause})) . \
              ?child rdfs:subClassOf ?parent . \
              ?parent a owl:Class . \
              ?parent #{preferredNameCode} ?parentLabel . \
              ?parent #{codeCode} ?parentCode \
            } \
            FILTER (?child != ?parent) \
          } \
          UNION \
          { \
            { \
              ?child a owl:Class . \
              ?child #{codeCode} ?conceptCode . \
              FILTER (?conceptCode IN (#{inClause})) . \
              ?equiv_concept owl:intersectionOf ?list . \
              ?list rdf:rest*/rdf:first ?parent . \
              ?child owl:equivalentClass ?equiv_concept . \
              ?parent a owl:Class . \
              ?parent #{preferredNameCode} ?parentLabel . \
              ?parent #{codeCode} ?parentCode \
            } \
            FILTER (?child? != ?parent) \
          } \
        } \
} \
ORDER by ?conceptCode ?parentLabel

subset=SELECT ?conceptLabel ?conceptCode \
{ \
    GRAPH <#{namedGraph}> \
    { \
        ?x a owl:Class . \
        ?x #{preferredNameCode} ?conceptLabel . \
        ?x #{codeCode} ?conceptCode . \
        ?y a owl:AnnotationProperty . \
        ?x ?y ?z . \
        ?z #{codeCode} "#{conceptCode}"^^xsd:string . \
        ?y rdfs:label "Concept_In_Subset"^^xsd:string \
    } \
}

#         OPTIONAL { ?relationship #{codeCode} ?relationshipCode . \
associations=SELECT ?relationship ?relationshipLabel ?relatedConcept ?relatedConceptCode ?relatedConceptLabel \
{ \
    GRAPH <#{namedGraph}> \
    { \f
        ?x a owl:Class . \
        ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
        ?relationship a owl:AnnotationProperty . \
        ?x ?relationship ?relatedConcept . \
        ?relatedConcept a owl:Class . \
        OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
        OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
        OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
        ?relationship rdfs:range ?y_range \
    } \
    FILTER (str(?y_range)=\"http://www.w3.org/2001/XMLSchema#anyURI\") \
} \
ORDER BY ?relationship ?relatedConceptLabel

#        ?relationship #{codeCode} ?relationshipCode . \
associations.batch=SELECT ?conceptCode ?relationship ?relationshipLabel ?relatedConcept ?relatedConceptCode ?relatedConceptLabel \
{ \
    GRAPH <#{namedGraph}> \
    { \
        ?x a owl:Class . \
        ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
        ?relationship a owl:AnnotationProperty . \
        ?x ?relationship ?relatedConcept . \
        ?relatedConcept a owl:Class . \
        OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
        OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
        OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
        ?relationship rdfs:range ?y_range \
    } \
    FILTER (str(?y_range)="http://www.w3.org/2001/XMLSchema#anyURI") \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

#        ?relationship #{codeCode} ?relationshipCode . \
inverse.associations=SELECT ?relationship ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ \
    GRAPH <#{namedGraph}> \
    { \
        ?z a owl:Class . \
        ?z #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
        ?relatedConcept a owl:Class . \
        OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
        OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
        ?relationship a owl:AnnotationProperty . \
        ?relatedConcept ?relationship ?z . \
        OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
        ?relationship rdfs:range ?y_range \
    } \
    FILTER (str(?y_range)=\"http://www.w3.org/2001/XMLSchema#anyURI\") \
} \
ORDER BY ?relationship ?relatedConceptLabel

#         ?relationship #{codeCode} ?relationshipCode . \
inverse.associations.batch=SELECT ?conceptCode ?relationship ?relationshipLabel ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ \
    GRAPH <#{namedGraph}> \
    { \
        ?z a owl:Class . \
        ?z #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
        ?relatedConcept a owl:Class . \
        OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } . \
        OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
        ?relationship a owl:AnnotationProperty . \
        ?relatedConcept ?relationship ?z . \
        OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
        ?relationship rdfs:range ?y_range \
    } \
    FILTER (str(?y_range)="http://www.w3.org/2001/XMLSchema#anyURI") \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

inverse.roles=SELECT distinct ?relationship ?relationshipCode ?relationshipLabel ?relatedConceptLabel ?relatedConceptCode \
{ \
    GRAPH <#{namedGraph}> \
    { \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Class . \
	    ?z5 owl:intersectionOf ?z6 . \
	    ?z6 rdf:rest*/rdf:first ?z7 . \
	    ?z7 a owl:Restriction . \
	    ?z7 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z7 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode. \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:unionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Class . \
	    ?z5 owl:intersectionOf ?z6 . \
	    ?z6 rdf:rest*/rdf:first ?z7 . \
	    ?z7 a owl:Restriction . \
	    ?z7 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z7 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:unionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:unionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:unionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Restriction . \
	    ?z1 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z1 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
    } \
}  \
ORDER BY ?relationship ?relatedConceptLabel

inverse.roles.chebi=SELECT distinct ?relationship ?relationshipCode ?relationshipLabel ?relatedConceptLabel ?relatedConceptCode \
{ \
    GRAPH <#{namedGraph}> \
    { \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Restriction . \
	    ?z1 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z1 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	  } \
    } \
}  \
ORDER BY ?relationship ?relatedConceptLabel

inverse.roles.batch=SELECT distinct ?conceptCode ?relationship ?relationshipCode ?relationshipLabel ?relatedConceptLabel ?relatedConceptCode \
{ \
    GRAPH <#{namedGraph}> \
    { \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Class . \
	    ?z5 owl:intersectionOf ?z6 . \
	    ?z6 rdf:rest*/rdf:first ?z7 . \
	    ?z7 a owl:Restriction . \
	    ?z7 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z7 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode. \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:unionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Class . \
	    ?z5 owl:intersectionOf ?z6 . \
	    ?z6 rdf:rest*/rdf:first ?z7 . \
	    ?z7 a owl:Restriction . \
	    ?z7 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z7 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:unionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:unionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:unionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?relatedConceptCode . \
	    ?x #{preferredNameCode} ?relatedConceptLabel . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Restriction . \
	    ?z1 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z1 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	  } \
    } \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

# constructRolesQuery(String conceptCode, String namedGraph)
roles=SELECT distinct ?relationship ?relationshipCode ?relationshipLabel ?relatedConceptLabel ?relatedConceptCode  \
{ \
    graph <#{namedGraph}> \
    { \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Class . \
	    ?z5 owl:intersectionOf ?z6 . \
	    ?z6 rdf:rest*/rdf:first ?z7 . \
	    ?z7 a owl:Restriction . \
	    ?z7 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z7 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL {  ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode. \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:unionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Class . \
	    ?z5 owl:intersectionOf ?z6 . \
	    ?z6 rdf:rest*/rdf:first ?z7 . \
	    ?z7 a owl:Restriction . \
	    ?z7 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z7 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:unionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:unionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:unionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} "#{conceptCode}"^^<http://www.w3.org/2001/XMLSchema#string> . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Restriction . \
	    ?z1 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationship } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z1 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
    } \
} \
ORDER BY ?relationship ?relatedConceptLabel

roles.batch=SELECT distinct ?conceptCode ?relationship ?relationshipCode ?relationshipLabel ?relatedConceptLabel ?relatedConceptCode \
{ \
    graph <#{namedGraph}> \
    { \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Class . \
	    ?z5 owl:intersectionOf ?z6 . \
	    ?z6 rdf:rest*/rdf:first ?z7 . \
	    ?z7 a owl:Restriction . \
	    ?z7 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z7 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode. \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:unionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Class . \
	    ?z5 owl:intersectionOf ?z6 . \
	    ?z6 rdf:rest*/rdf:first ?z7 . \
	    ?z7 a owl:Restriction . \
	    ?z7 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z7 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:unionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x owl:equivalentClass ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel} . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:intersectionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:unionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Class . \
	    ?z3 owl:intersectionOf ?z4 . \
	    ?z4 rdf:rest*/rdf:first ?z5 . \
	    ?z5 a owl:Restriction . \
	    ?z5 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z5 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Class . \
	    ?z1 owl:unionOf ?z2 . \
	    ?z2 rdf:rest*/rdf:first ?z3 . \
	    ?z3 a owl:Restriction . \
	    ?z3 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z3 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
	  UNION \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Restriction . \
	    ?z1 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z1 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
   } \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

roles.batch.chebi=SELECT distinct ?conceptCode ?relationship ?relationshipCode ?relationshipLabel ?relatedConceptLabel ?relatedConceptCode \
{ \
    graph <#{namedGraph}> \
    { \
	  { ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
	    ?x rdfs:subClassOf ?z1 . \
	    ?z1 a owl:Restriction . \
	    ?z1 owl:onProperty ?relationship . \
	    OPTIONAL { ?relationship #{preferredNameCode} ?relationshipLabel } . \
	    ?relationship #{codeCode} ?relationshipCode . \
	    ?z1 owl:someValuesFrom ?y . \
	    ?y a owl:Class . \
	    ?y #{preferredNameCode} ?relatedConceptLabel . \
	    ?y #{codeCode} ?relatedConceptCode . \
	  } \
   } \
} \
ORDER BY ?conceptCode ?relationship ?relatedConceptLabel

# relationship label is bound to "disjointWith"
disjoint.with=SELECT ?relatedConcept ?relatedConceptLabel ?relatedConceptCode \
{ \
    GRAPH <#{namedGraph}> \
    { \
        ?x a owl:Class . \
        ?x #{codeCode} "#{conceptCode}" . \
        ?x owl:disjointWith ?relatedConcept . \
        OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
        OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } \
    } \
}

# relationship label is bound to "disjointWith"
disjoint.with.batch=SELECT ?conceptCode ?relatedConcept ?relatedConceptCode ?relatedConceptLabel \
{ \
    GRAPH <#{namedGraph}> \
    { \
        ?x a owl:Class . \
        ?x #{codeCode} ?conceptCode . \
        FILTER (?conceptCode IN (#{inClause})) . \
        ?x owl:disjointWith ?relatedConcept . \
        OPTIONAL { ?relatedConcept #{codeCode} ?relatedConceptCode } . \
        OPTIONAL { ?relatedConcept #{preferredNameCode} ?relatedConceptLabel } \
    } \
} \
ORDER BY ?conceptCode

# constructHierarchyQuery(String namedGraph)
# (1) owl:Class|rdfs:subClassOf|owl:Class
# (2) owl:Class|owl:equivalentClass|owl:Class|owl:intersectionOf|owl:Class
# (3) owl:Class|rdfs:subClassOf|owl:Class|owl:intersectionOf|owl:Class
hierarchy=SELECT ?parent ?parentCode ?parentLabel ?child ?childCode ?childLabel \
    { \
    GRAPH <#{namedGraph}> \
      { \
        { \
          { \
            ?child a owl:Class . \
            OPTIONAL { ?child #{preferredNameCode} ?childLabel } . \
            ?child #{codeCode} ?childCode . \
            ?child rdfs:subClassOf ?parent . \
            ?parent a owl:Class . \
            OPTIONAL { ?parent #{preferredNameCode} ?parentLabel } . \
            ?parent #{codeCode} ?parentCode \
          } \
        } \
        UNION \
        { \
          { \
            ?child a owl:Class . \
            OPTIONAL {  ?child #{preferredNameCode} ?childLabel } . \
            ?child #{codeCode} ?childCode . \
            ?child owl:equivalentClass ?y . \
            ?y a owl:Class . \
            ?y owl:intersectionOf ?list . \
            ?list rdf:rest*/rdf:first ?parent . \
            ?parent a owl:Class . \
            OPTIONAL { ?parent #{preferredNameCode} ?parentLabel } . \
            ?parent #{codeCode} ?parentCode \
          } \
        } \
        UNION \
        { \
          { \
            ?child a owl:Class . \
            OPTIONAL { ?child #{preferredNameCode} ?childLabel } . \
            ?child #{codeCode} ?childCode . \
            ?child rdfs:subClassOf ?y . \
            ?y a owl:Class . \
            ?y owl:intersectionOf ?list . \
            ?list rdf:rest*/rdf:first ?parent . \
            ?parent a owl:Class . \
            OPTIONAL { ?parent #{preferredNameCode} ?parentLabel } . \
            ?parent #{codeCode} ?parentCode \
          } \
        } \
      } \
    }

# Get all properties with literal values not URI values
all.properties=SELECT ?property ?propertyCode \
{ GRAPH <#{namedGraph}> \
  { ?property a owl:AnnotationProperty . \
    OPTIONAL { ?property #{codeCode} ?propertyCode } . \
    FILTER NOT EXISTS { ?property rdfs:range xml:anyURI } \
  } \
}


# distinct property values (String properytCode, String namedGraph)
# for all concepts, regardless of status
distinct.property.values=SELECT DISTINCT ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { ?c a owl:Class . \
    ?c #{propertyCode} ?propertyValue \
  } \
}

# constructAllQualifiersQuery(String namedGraph)
all.qualifiers=SELECT DISTINCT ?propertyCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?z_axiom owl:annotatedProperty ?p . \
    ?p a owl:AnnotationProperty . \
    ?qualifier a owl:AnnotationProperty . \
    ?z_axiom ?qualifier ?z . \
    ?qualifier #{codeCode} ?propertyCode \
  } \
} \
ORDER BY ?propertyCode

all.properties.never.used=SELECT DISTINCT ?property ?propertyCode \
{ GRAPH <#{namedGraph}> \
  { \
    ?property a owl:AnnotationProperty . \
    ?property #{codeCode} ?propertyCode . \
    FILTER NOT EXISTS { ?x ?property ?z } \
  } \
} \
ORDER BY ?propertyCode

# Annotation properties with URI range (to differentiate from properties)
all.associations=SELECT ?property ?propertyCode  \
{ GRAPH <#{namedGraph}> \
  { ?property a owl:AnnotationProperty . \
    ?property #{codeCode} ?propertyCode . \
    ?property rdfs:range xml:anyURI  \
  } \
}

# constructAllRolesQuery(String namedGraph)
all.roles=SELECT ?property ?propertyCode  \
{ GRAPH <#{namedGraph}> \
  { ?property a owl:ObjectProperty . \
    ?property #{codeCode} ?propertyCode . \
  } \
}

# find all property values used for the specified axiom qualifier
# except those values used on retired concepts
axiom.qualifier.values=SELECT DISTINCT ?propertyValue \
{ GRAPH <#{namedGraph}> \
  { \
    ?a a owl:Axiom . \
    ?c a owl:Class . \
    ?a owl:annotatedSource ?c . \
    ?a #{propertyCode} ?propertyValue . \
    FILTER NOT EXISTS { ?c #{conceptStatusCode} "#{retiredStatusValue}" } \
  } \
} \
ORDER BY ?propertyValue

# batch queries
all.concepts=SELECT ?concept ?conceptCode ?conceptLabel \
{ GRAPH <#{namedGraph}> { \
        ?concept a owl:Class . \
        ?concept #{codeCode} ?conceptCode \
        OPTIONAL { ?concept #{preferredNameCode} ?conceptLabel } . \
    } \
} \
ORDER BY ?conceptCode 

associationEntries=SELECT ?conceptCode ?conceptLabel ?relatedConceptCode ?relatedConceptLabel \
{ \
    GRAPH <#{namedGraph}> \
    { \
        ?x a owl:Class . \
        ?x #{codeCode} ?conceptCode . \
        ?x #{preferredNameCode} ?conceptLabel . \
        ?y a owl:AnnotationProperty . \
        ?x ?y ?z . \
        ?z a owl:Class . \
        ?z #{preferredNameCode} ?relatedConceptLabel . \
        ?z #{codeCode} ?relatedConceptCode . \
        ?y #{codeCode} "#{conceptCode}" . \
        ?y rdfs:range ?y_range \
    } \
    FILTER (str(?y_range)=\"http://www.w3.org/2001/XMLSchema#anyURI\") \
}
